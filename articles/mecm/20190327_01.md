---
title: System Center Configuration Manager Current Branch クライアントに関連する情報を完全に削除する方法
date: 2019-03-27
tags:
  - MECM
---

皆様、こんにちは。System Center Configuration Manager サポート チームです。

以前のバージョンの System Center Configuration Manager クライアントを完全に削除する手順については、次の通りご紹介しておりますが、今回は最新版である System Center Configuration Manager Current Branch の場合の手順をご案内します。

https://social.msdn.microsoft.com/Forums/ja-JP/bb8fc444-ec6e-43ac-a077-9ebea7abb4a2/sccm2012-sccm?forum=jpsccmwsus

System Center Configuration Manager クライアントの完全削除は、クライアントが正常に動作していないように見える場合に有効な手順です。本手順を実施してから、クライアントの再インストールを実施することで解消できる問題も多くありますので、回避優先の対処が求められる場合に、是非お役立てください。


>**注意事項 : 本手順は、SCCM クライアントがインストールされた、サイト サーバー、サイト システム サーバー (SCCM のサーバー側の管理ポイント・配布ポイントなどの役割を持つサーバー) では行わないでください。手順中で削除が必要なレジストリ キーは、SCCM のサーバー側各機能でも使用していることが多く、サイト サーバー、サイト システムとしての役割に支障をきたします。本手順は、あくまでも、クライアント OS の SCCM クライアントへのトラブルシュートや、マスター イメージ準備のためにご利用ください。**

---
1. System Center Configuration Manager クライアントをアンインストールします。

コマンド プロンプトを管理者として実行し、以下のコマンドを実行します。

`%Windir%\ccmsetup\ccmsetup.exe /uninstall`

>コントロールパネルを開き、"Configuration Manager" という項目が消えたら、アンインストール完了と判断出来ます。また、アンインストールが成功すると、ccmsetup.log に以下のログが記録されます。

`Uninstall succeeded.`

2. 下記フォルダー、ファイルを削除します。

```
%windir%\CCM
%windir%\ccmsetup
%windir%\SMSCFG.ini
```
 
3. 下記レジストリが残存している場合、削除します。

```
HKEY_LOCAL_MACHINE\Software\Microsoft\SMS
HKEY_LOCAL_MACHINE\Software\Microsoft\CCM
HKEY_LOCAL_MACHINE\Software\Microsoft\CCMSetup
```
 

4. 以下の手順で、SMS 証明書(自己署名証明書) を削除します。

1) コマンド プロンプトを開き、"mmc" を入力して実行します。
2) [ファイル] - [スナップインの追加と削除] をクリックします。
3) 左ペインから [証明書] をクリックして [追加] ボタンをクリックします。
4) "コンピューター アカウント" にチェックを入れて、[次へ] をクリックします。
5) "ローカル コンピューター" にチェックし、[完了] をクリックします。
6) 右ペインに "証明書（ローカル コンピューター）" が追加されていることを確認し [OK] をクリックします。
7) 左ペインにて、[証明書] - [SMS] - [証明書] を選択します。
8) 中央ペインに表示された 2 つの "SMS" 証明書に対して、それぞれ右クリックして [削除] を選択します。
「選択された証明書を永久的に削除しますか?」というメッセージが表示されますので、[はい] を選択します。
9) [ファイル] - [終了] をクリックします。「コンソールの設定を コンソール1 に保存しますか?」というメッセージが表示されますので、[いいえ] を選択して、mmc を終了します。

>PKI 証明書を利用している環境（HTTPS 構成）の場合
>PKI 証明書を利用している場合は同様に以下の手順で PKI 証明書を削除します。
>1) コマンド プロンプトを開き、"mmc" を入力して実行します。
>2) [ファイル] - [スナップインの追加と削除] をクリックします。
>3) 左ペインから [証明書] をクリックして [追加] ボタンをクリックします。
>4) "コンピューター アカウント" にチェックを入れて、[次へ] をクリックします。
>5) "ローカル コンピューター" にチェックし、[完了] をクリックします。
>6) 右ペインに "証明書（ローカル コンピューター）" が追加されていることを確認し [OK] をクリックします。
>7) 左ペインにて、[証明書] - [個人] - [証明書] を選択します。カスタム ストアを利用している場合は、該当箇所を選択してください。
>8) 中央ペインに表示された SCCM の HTTPS 接続用クライアント証明書を右クリックして [削除] を選択します。
「選択された証明書を永久的に削除しますか?」というメッセージが表示されますので、[はい] を選択します。
>9) [ファイル] - [終了] をクリックします。「コンソールの設定を コンソール1 に保存しますか?」というメッセージが表示されますので、[いいえ] を選択して、mmc を終了します。

5. 下記フォルダーに移動し、"19c5cf..." ではじまるファイルが存在する場合には削除、またはリネームして別フォルダにコピーします。(該当のファイルが存在しない場合も問題ありません。)

`C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys`
>※ ProgramData フォルダーは隠しフォルダーです。

6. ソフトウェア センターのショートカットが含まれる下記フォルダーを削除します。SCCM 管理コンソールをインストールしている場合は、「Configuraiotn Manager コンソール」のリンクなども本フォルダーに含まれます。管理コンソールはアンインストールしない場合などは、必要に応じて「ソフトウェア センター」のショートカットのみ削除してください。

`C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft System Center`
>※ ProgramData フォルダーは隠しフォルダーです。